<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 xmlns:wc="using:WonderLab.Controls"
			 xmlns:wce="using:WonderLab.Classes.Enums"
			 xmlns:wa="using:WonderLab.Media.Attachments"
			 xmlns:mbe="using:MinecraftLaunch.Base.Enums"
			 xmlns:wem="using:WonderLab.Extensions.Markup"
             x:Class="WonderLab.SearchPage">
	<UserControl.Resources>
		<RecyclingElementFactory x:Key="ResourceTemplateSelector">
			<RecyclingElementFactory.Templates>
				<DataTemplate x:Key="Minecraft">
					<wc:NavigationTile Classes="content"
									   IsEnableAnimation="False"
									   Title="{Binding Id}">
						<wc:NavigationTile.Icon>
							<Border Width="40"
									Height="40"
									CornerRadius="{StaticResource WeakCornerRadius}">
								<Border.Background>
									<ImageBrush Source="{Binding, Converter={StaticResource MinecraftIconConverter}}"/>
								</Border.Background>
							</Border>
						</wc:NavigationTile.Icon>

						<wc:NavigationTile.Description>
							<Grid Margin="0 2 0 0"
								  ColumnDefinitions="auto *">
								<wc:Tag Text="{Binding Type}"/>
								
								<TextBlock Margin="8 0 0 0"
										   Classes="Caption"
										   VerticalAlignment="Center"
										   TextTrimming="CharacterEllipsis"
										   Text="{Binding ReleaseTime}"
										   Grid.Column="1"/>
							</Grid>
						</wc:NavigationTile.Description>
					</wc:NavigationTile>
				</DataTemplate>
			</RecyclingElementFactory.Templates>
		</RecyclingElementFactory>
	</UserControl.Resources>

	<Interaction.Behaviors>
		<EventTriggerBehavior EventName="Loaded">
			<InvokeCommandAction Command="{Binding LoadedCommand}"/>
		</EventTriggerBehavior>

		<EventTriggerBehavior EventName="UnNavigated">
			<InvokeCommandAction Command="{Binding UnNavigatedCommand}"/>
		</EventTriggerBehavior>
	</Interaction.Behaviors>
	
	<Grid RowSpacing="12"
		  RowDefinitions="auto, *">
		<WrapPanel LineSpacing="8"
				   ItemSpacing="8"
				   Orientation="Horizontal">
			<!--Type-->
			<ComboBox CornerRadius="6"
					  SelectedItem="{Binding SearchType}"
					  Background="{DynamicResource TextBoxBackgroundBrush}"
					  ItemsSource="{wem:EnumBinding {x:Type wce:SearchType}}"/>

			<!--Minecraft type-->
			<ComboBox CornerRadius="6"
					  Background="{DynamicResource TextBoxBackgroundBrush}"
					  SelectedItem="{Binding MinecraftVersionType, Mode=TwoWay}"
					  ItemsSource="{wem:EnumBinding {x:Type mbe:MinecraftVersionType}}"
					  IsVisible="{Binding IsCommunityResourcesFilterVisible, Converter={StaticResource BoolReverseConverter}}"/>

			<!--Community resources-->
			<ComboBox CornerRadius="6"
					  Background="{DynamicResource TextBoxBackgroundBrush}"
					  IsVisible="{Binding IsCommunityResourcesFilterVisible}">
				<ComboBoxItem Content="All"/>
			</ComboBox>

			<ComboBox CornerRadius="6"
					  Background="{DynamicResource TextBoxBackgroundBrush}"
					  IsVisible="{Binding IsCommunityResourcesFilterVisible}">
				<ComboBoxItem Content="Modrinth"/>
				<ComboBoxItem Content="Curseforge"/>
			</ComboBox>
		</WrapPanel>

		<ScrollViewer Grid.Row="1">
			<ItemsRepeater Margin="0 0 16 0"
						   ItemsSource="{Binding Resources}"
						   ItemTemplate="{StaticResource ResourceTemplateSelector}"
						   wa:ItemsRepeaterExtensions.AnimatedScroll="True">
				<ItemsRepeater.Layout>
					<StackLayout Spacing="8"/>
				</ItemsRepeater.Layout>
			</ItemsRepeater>
		</ScrollViewer>
	</Grid>
</UserControl>