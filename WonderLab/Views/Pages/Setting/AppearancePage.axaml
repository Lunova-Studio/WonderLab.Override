<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="1450"
			 xmlns:wc="using:WonderLab.Controls"
			 xmlns:wce="using:WonderLab.Classes.Enums"
			 xmlns:wa="using:WonderLab.Media.Attachments"
			 xmlns:wem="using:WonderLab.Extensions.Markup"
			 xmlns:wb="using:WonderLab.Media.Behaviors"
			 xmlns:me="using:Monet.Shared.Enums"
             x:Class="WonderLab.AppearancePage">
	<UserControl.Resources>
		<DataTemplate x:Key="ColorsTemplate">
			<Border Width="25"
					Height="25"
					Opacity="0.8"
					Background="{Binding Brush}"
					CornerRadius="{StaticResource FullCornerRadius}"
					ToolTip.Tip="{Binding Key}"/>
		</DataTemplate>
	</UserControl.Resources>
	
	<Interaction.Behaviors>
		<EventTriggerBehavior EventName="Loaded">
			<InvokeCommandAction Command="{Binding LoadedCommand}"/>
		</EventTriggerBehavior>
	</Interaction.Behaviors>

	<ItemsControl Margin="0 0 16 24">
		<ItemsControl.ItemsPanel>
			<ItemsPanelTemplate>
				<StackPanel Spacing="8"/>
			</ItemsPanelTemplate>
		</ItemsControl.ItemsPanel>

		<Border Width="250"
				Padding="12"
				Height="150"
				Margin="0 0 0 8"
				BorderThickness="3"
				VerticalAlignment="Top"
				HorizontalAlignment="Left"
				BorderBrush="{DynamicResource OutlineBrush}"
				CornerRadius="{DynamicResource StrongCornerRadius}"
				Background="{DynamicResource ApplicationBackgroundBrush}"
				RenderOptions.BitmapInterpolationMode="LowQuality">
			<Interaction.Behaviors>
				<wb:PreviewWindowBackgroundBehavior/>
			</Interaction.Behaviors>

			<StackPanel Spacing="4"
						HorizontalAlignment="Left"
						VerticalAlignment="Bottom">
				<Border Width="60"
						Height="25"
						BorderThickness="1.5"
						CornerRadius="{DynamicResource WeakCornerRadius}"
						Background="{DynamicResource ButtonBackgroundBrush}"
						BorderBrush="{DynamicResource PrimaryButtonBackgroundBrush}"/>

				<Border Width="40"
						Height="15"
						HorizontalAlignment="Left"
						CornerRadius="{DynamicResource WeakCornerRadius}"
						Background="{DynamicResource PrimaryButtonBackgroundBrush}"/>
			</StackPanel>
		</Border>

		<wc:SettingCard Icon="&#xE793;"
						Header="整体主题"
						Background="{DynamicResource SettingCardsBackgroundBrush}">
			<ListBox Classes="segmented"
					 SelectedIndex="{Binding ActiveThemeIndex}">
				<ListBoxItem Tag="&#xE770;"
							 Content="系统"/>

				<ListBoxItem Tag="&#xE706;"
							 Content="亮色"/>

				<ListBoxItem Tag="&#xE708;"
							 Content="暗色"/>
			</ListBox>
		</wc:SettingCard>

		<wc:SettingCards Margin="0 12 0 0"
						 Header="主题">
			<wc:SettingCard Icon="&#xE790;"
							Header="主题色"
							IsVisible="{Binding IsEnableBitmapColor, Converter={StaticResource BoolReverseConverter}}">
				<ListBox Classes="colors"
						 Margin="-12 0 0 0"
						 ItemsSource="{Binding Colors}"
						 SelectedItem="{Binding ActiveColor}"
						 ItemTemplate="{StaticResource ColorsTemplate}"
						 IsEnabled="{Binding IsEnableSystemColor, Converter={StaticResource BoolReverseConverter}}"/>
			</wc:SettingCard>

			<Separator Margin="16 0" Padding="0" Height="1" Opacity="0.2"
					   IsVisible="{Binding IsEnableBitmapColor, Converter={StaticResource BoolReverseConverter}}"/>

			<wc:SettingCard Icon="&#xE770;"
							Header="使用系统主题色">
				<ToggleSwitch IsChecked="{Binding IsEnableSystemColor}"/>
			</wc:SettingCard>

			<Separator Margin="16 0" Padding="0" Height="1" Opacity="0.2"
					   IsVisible="{Binding IsBitmapBackground}"/>

			<wc:SettingCard Icon="&#xEF3C;"
							Header="使用自动取色"
							IsVisible="{Binding IsBitmapBackground}"
							IsEnabled="{Binding IsEnableSystemColor, Converter={StaticResource BoolReverseConverter}}">
				<ToggleSwitch IsChecked="{Binding IsEnableBitmapColor}"/>
			</wc:SettingCard>

			<Separator Margin="16 0" Padding="0" Height="1" Opacity="0.2"/>

			<wc:SettingCard Icon="&#xEBC6;"
							Header="选择动态主题色方案">
				<ComboBox SelectedIndex="{Binding ActiveColorVariant}"
						  ItemsSource="{wem:EnumBinding {x:Type me:Variant}}"/>
			</wc:SettingCard>
		</wc:SettingCards>

		<wc:SettingCards Margin="0 12 0 0"
						 Header="背景">
			<wc:SettingCard Icon="&#xEF1F;"
							Header="背景类型">
				<ComboBox SelectedItem="{Binding ActiveBackground}"
						  ItemsSource="{Binding Backgrounds, Mode=TwoWay}"/>
			</wc:SettingCard>

			<Separator Margin="16 0" Padding="0" Height="1" Opacity="0.2"
					   IsVisible="{Binding IsBitmapBackground}"/>

			<wc:SettingCard Icon="&#xE7C5;"
							Header="背景图片路径"
							IsVisible="{Binding IsBitmapBackground}">
				<TextBox MinWidth="300"
						 MaxWidth="500"
						 Text="{Binding ImagePath, Mode=TwoWay}">
					<TextBox.InnerRightContent>
						<Button Classes="icon"
								Margin="0 0 4 0"
								Content="&#xED43;"
								Command="{Binding BrowserImageCommand}"/>
					</TextBox.InnerRightContent>
				</TextBox>
			</wc:SettingCard>
		</wc:SettingCards>

		<wc:SettingCards Margin="0 12 0 0"
						 Header="语言">
			<wc:SettingCard Icon="&#xF2B7;"
							Header="选择语言">
				<ComboBox MinWidth="150"
						  ItemsSource="{Binding Languages}"
						  SelectedItem="{Binding ActiveLanguage}">
					<ComboBox.ItemTemplate>
						<DataTemplate>
							<DockPanel>
								<TextBlock Classes="Body"
										   VerticalAlignment="Center"
										   TextTrimming="CharacterEllipsis"
										   Text="{Binding DisplayName}"
										   DockPanel.Dock="Left"/>

								<TextBlock Classes="Body"
										   Margin="16 0 0 0"
										   VerticalAlignment="Center"
										   HorizontalAlignment="Right"
										   Text="{Binding LanguageCode}"
										   Foreground="{DynamicResource ApplicationSubtitleForegroundBrush}"
										   DockPanel.Dock="Right"/>
							</DockPanel>
						</DataTemplate>
					</ComboBox.ItemTemplate>
				</ComboBox>
			</wc:SettingCard>
		</wc:SettingCards>
	</ItemsControl>
</UserControl>